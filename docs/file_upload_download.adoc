= File Upload and Download

== File Upload

To upload a file:

1. Send a POST request to the `/api/v1/file/{bucket}` endpoint.

Example request:

```sh
curl -i http://localhost:8081/api/v1/file/mybucket -F file=@./my-image.png;type=image/png
```

Example response:

```sh
{
	"fileIdentifier": "0050559c-beae-48d6-a2b0-91f5a666fad1",
	"metaFileEntryVersion": "1.0",
	"originalFilename": "example-png.png",
	"sha1Hex": "c0c1d898ed827d6db02a03df941225184277d9e5",
	"receivedMediaType": "image/png",
	"detectedMediaType": "image/png",
	"detectedFileExtension": ".png",
	"evaluatedMediaType": "image/png",
	"evaluatedFileExtension": ".png",
	"sizeInBytes": 976,
	"thumbnailIdentifier": "b9f6f58b-1b41-400f-b178-f91d11221b7c"
}

```

2. Send a POST request to the `/api/v1/metadata` endpoint to create a Metadata record for the stored
object, using the fileIdentifier from the upload response.

```sh
curl -X POST http://localhost:8081/api/v1/metadata \
-H "Content-Type: application/vnd.api+json" \
-H "Accept: application/vnd.api+json" \
--data-binary @- << EOF
{
  "data": {
    "type": "metadata",
    "attributes": {
      "bucket": "mybucket",
      "dcType": "Image",
      "fileExtension": ".png",
      "fileIdentifier": "0050559c-beae-48d6-a2b0-91f5a666fad1"
    }
  }
}
EOF
```

== File Download

To download a stored object, send a GET request to the `/api/v1/file/{bucket}/{fileId}` endpoint.

Example request:

```sh
curl http:/localhost:8081/api/v1/file/mybucket/0050559c-beae-48d6-a2b0-91f5a666fad1 > my-downloaded-image.png
```

== File Thumbnail Download

A thumbnail is automatically generated when an image file is uploaded.

A thumbnails metadata is automatically generated when an image file's metadata is uploaded. 

The thumbnails metadata contains the thumbnails file identifier and the UUID of the original resources metada.

To download the thumbnail:

. Get the UUID of the original resouces metadata
. Send a request to get the thumbnails meta data 

```
/metadata?filter[acDerivedFrom.id][EQ]={UUID_OF_ORIGINAL_RESOUCE_METADATA}
```
. Use the thumbnails metadata's file identifier value to download the thumbnail

```
/file/mybucket/{THUMBNAIL_FILE_IDENTIFIER}
```
